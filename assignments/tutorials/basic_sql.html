<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Introduction to SQL &mdash; Python 401 2.1 documentation</title>
    
    <link rel="stylesheet" href="../../_static/pyramid.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '2.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="top" title="Python 401 2.1 documentation" href="../../index.html" />
<link rel="stylesheet" href="http://fonts.googleapis.com/css?family=Neuton&amp;subset=latin" type="text/css" media="screen" charset="utf-8" />
<link rel="stylesheet" href="http://fonts.googleapis.com/css?family=Nobile:regular,italic,bold,bolditalic&amp;subset=latin" type="text/css" media="screen" charset="utf-8" />

<link rel="stylesheet" href="../../_static/custom.css" type="text/css" media="screen" charset="utf-8" />

<!--[if lte IE 6]>
<link rel="stylesheet" href="../../_static/ie6.css" type="text/css" media="screen" charset="utf-8" />
<![endif]-->

  </head>
  <body role="document">
<div class="header">
  <div class="logo">
    <a href="../../index.html">
      <img class="logo" src="../../_static/cf_logo.png" alt="Logo"/>
      <p>Code Fellows</p>
    </a>
  </div>
</div>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="nav-item nav-item-0"><a href="../../index.html">Python 401 2.1 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput,
div.nbinput > div,
div.nbinput div[class^=highlight],
div.nbinput div[class^=highlight] pre,
div.nboutput,
div.nboutput > div,
div.nboutput div[class^=highlight],
div.nboutput div[class^=highlight] pre {
    background: none;
    border: none;
    padding: 0 0;
    margin: 0;
    box-shadow: none;
}

/* input/output containers */
div.nbinput,
div.nboutput {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
}

/* input container */
div.nbinput {
    padding-top: 5px;
}

/* last container */
div.nblast {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput > :first-child pre {
    color: navy;
}

/* output prompt */
div.nboutput > :first-child pre {
    color: darkred;
}

/* all prompts */
div.nbinput > :first-child[class^=highlight],
div.nboutput > :first-child[class^=highlight],
div.nboutput > :first-child {
    min-width: 11ex;
    padding-top: 0.4em;
    padding-right: 0.4em;
    text-align: right;
    flex: 0;
}

/* input/output area */
div.nbinput > :nth-child(2)[class^=highlight],
div.nboutput > :nth-child(2),
div.nboutput > :nth-child(2)[class^=highlight] {
    padding: 0.4em;
    -webkit-flex: 1;
    flex: 1;
}

/* input area */
div.nbinput > :nth-child(2)[class^=highlight] {
    border: 1px solid #cfcfcf;
    border-radius: 2px;
    background: #f7f7f7;
}

/* override MathJax center alignment in output cells */
div.nboutput div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.pngmath center alignment in output cells */
div.nboutput div.math p {
    text-align: left;
}

/* standard error */
div.nboutput  > :nth-child(2).stderr {
    background: #fdd;
}

/* ANSI colors */
.ansiblack { color: black; }
.ansired { color: darkred; }
.ansigreen { color: darkgreen; }
.ansiyellow { color: #c4a000; }
.ansiblue { color: darkblue; }
.ansipurple { color: darkviolet; }
.ansicyan { color: steelblue; }
/* See https://github.com/jupyter/nbconvert/issues/174 */
.ansigray { color: gray; }  /* nbconvert CSS */
.ansigrey { color: gray; }  /* nbconvert HTML output */

.ansibgblack { background-color: black; }
.ansibgred { background-color: red; }
.ansibggreen { background-color: green; }
.ansibgyellow { background-color: yellow; }
.ansibgblue { background-color: blue; }
.ansibgpurple { background-color: magenta; }
.ansibgcyan { background-color: cyan; }
.ansibggray { background-color: gray; }

.ansibold { font-weight: bold; }
</style>
<div class="section" id="introduction-to-sql">
<h1>Introduction to SQL<a class="headerlink" href="#introduction-to-sql" title="Permalink to this headline">¶</a></h1>
<div class="line-block">
<div class="line"><strong>A quick overview of SQL</strong></div>
<div class="line">History, Concepts, and Syntax</div>
</div>
<div class="section" id="what-is-sql">
<h2>What is SQL<a class="headerlink" href="#what-is-sql" title="Permalink to this headline">¶</a></h2>
<p><strong>SQL == Structured Query Language</strong></p>
<p>It was first invented in the early 1970s at IBM.
Based on <a class="reference external" href="http://en.wikipedia.org/wiki/Relational_algebra">Relational Algebra</a> and <a class="reference external" href="http://en.wikipedia.org/wiki/Tuple_relational_calculus">Tuple Relational Calculus</a>, it was used to get at data stored in their <code class="docutils literal"><span class="pre">System-R</span></code> database management system.
The idea was picked up by <em>Relational Software</em> (now <em>Oracle</em>) in the late 1970s, and let to their release of <code class="docutils literal"><span class="pre">Oracle</span> <span class="pre">V2</span></code>, the first commercial Relational Database, in 1979.
IBM followed with <code class="docutils literal"><span class="pre">System/38</span></code>, <code class="docutils literal"><span class="pre">SQL/DS</span></code> and <code class="docutils literal"><span class="pre">DB2</span></code> between 1979 and 1983.</p>
<p>source: <a class="reference external" href="http://en.wikipedia.org/wiki/SQL">http://en.wikipedia.org/wiki/SQL</a></p>
<p>SQL, and Relational Database Management Systems (RDBMS) have been the de-facto standard for data persistence for 30+ years.
Currently, there are more than 100 RDBMS available, both proprietary and open-source.
Most, if not all, include some implementation of SQL as their query language.</p>
<p>source: <a class="reference external" href="http://en.wikipedia.org/wiki/List_of_relational_database_management_systems">http://en.wikipedia.org/wiki/List_of_relational_database_management_systems</a></p>
<div class="section" id="big-players-in-sql">
<h3>Big Players in SQL<a class="headerlink" href="#big-players-in-sql" title="Permalink to this headline">¶</a></h3>
<p>There are a number of RDBMS that you will run into regularly</p>
<p><strong>Commercial / Proprietary</strong></p>
<ul class="build simple">
<li>MS SQL Server</li>
<li>Oracle</li>
<li>MySQL Enterprise (Oracle)</li>
</ul>
<p><strong>Open Source</strong></p>
<ul class="build simple">
<li>PostgreSQL</li>
<li>MySQL community (also owned by Oracle)</li>
<li>MariaDB (a community-owned fork of MySQL)</li>
<li>SQLite</li>
</ul>
</div>
</div>
<div class="section" id="sql-rdbms-concepts">
<h2>SQL/RDBMS Concepts<a class="headerlink" href="#sql-rdbms-concepts" title="Permalink to this headline">¶</a></h2>
<p>There are a few important concepts to understand when speaking about databases:</p>
<div class="section" id="tables">
<h3>Tables<a class="headerlink" href="#tables" title="Permalink to this headline">¶</a></h3>
<p>A table consists of <em>rows</em> (also called <em>records</em>) and <em>columns</em>.
Each row/record represents a single item.
Each column represents a data point within that item.
Most tables will have one column which is considered the <em>primary key</em> (but not all).
This value will uniquely identify a single row out of all the rows in the table.
The primary key of a table will be <em>indexed</em>, which allows the database system to find the row using that value spectacularly quickly.
Columns other than the primary key can also be indexed.</p>
<p>Here is an example table which represents people in a system:</p>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="31%" />
<col width="31%" />
<col width="28%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">id</th>
<th class="head">username</th>
<th class="head">first_name</th>
<th class="head">last_name</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>1</td>
<td>wont_u_b</td>
<td>Fred</td>
<td>Rogers</td>
</tr>
<tr class="row-odd"><td>4</td>
<td>neuroman</td>
<td>William</td>
<td>Gibson</td>
</tr>
<tr class="row-even"><td>5</td>
<td>race</td>
<td>Roger</td>
<td>Bannon</td>
</tr>
<tr class="row-odd"><td>6</td>
<td>harrywho</td>
<td>Harry</td>
<td>Houdini</td>
</tr>
<tr class="row-even"><td>7</td>
<td>whitequeen</td>
<td>Emma</td>
<td>Frost</td>
</tr>
<tr class="row-odd"><td>8</td>
<td>shadowcat</td>
<td>Kitty</td>
<td>Pryde</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="relations">
<h3>Relations<a class="headerlink" href="#relations" title="Permalink to this headline">¶</a></h3>
<p>You can <em>model</em> things using tables like this.
Adding columns for all sorts of different data points.
But what happens when not all of the items in a table share the <em>same</em> data points?
Or what if some of the items need to have more than one value for a particular data point?
Leaving columns empty in a row wastes memory and slows down querying.
Databases use <em>relations</em> to solve these types of problems.</p>
<p>There are three basic types of relationships:</p>
<dl class="build docutils">
<dt>Many-to-one relationships:</dt>
<dd>Used to represent relationships of ownership or belonging. Like product -&gt; manufacturer or book -&gt; author</dd>
<dt>One-to-one relationships:</dt>
<dd>Best used to represent aspects of an item which are not <em>core</em> to it.
Like user (id, password) -&gt; user_profile (preferences, name, address)</dd>
<dt>Many-to-many relationships:</dt>
<dd>Used to represent associations or membership.
Like users -&gt; groups or items -&gt; orders</dd>
</dl>
</div>
<div class="section" id="relations-1">
<h3>Relations: ∞ -&gt; 1<a class="headerlink" href="#relations-1" title="Permalink to this headline">¶</a></h3>
<p>Many-to-one relationships are modelled using <em>Foreign Keys</em>.
The <em>many</em> table has a column, the value of which is the <em>primary key</em> of the row from the <em>one</em> table.</p>
<p>Consider the relationship of books to author:</p>
<p><strong>People</strong>:</p>
<table border="1" class="docutils">
<colgroup>
<col width="11%" />
<col width="29%" />
<col width="32%" />
<col width="29%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">id</th>
<th class="head">username</th>
<th class="head">first_name</th>
<th class="head">last_name</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>4</td>
<td>neuroman</td>
<td>William</td>
<td>Gibson</td>
</tr>
<tr class="row-odd"><td>6</td>
<td>harrywho</td>
<td>Harry</td>
<td>Houdini</td>
</tr>
</tbody>
</table>
<p><strong>Books</strong>:</p>
<table border="1" class="docutils">
<colgroup>
<col width="9%" />
<col width="74%" />
<col width="17%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">id</th>
<th class="head">title</th>
<th class="head">author</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>1</td>
<td>Miracle Mongers and their Methods</td>
<td>6</td>
</tr>
<tr class="row-odd"><td>2</td>
<td>The Right Way to Do Wrong</td>
<td>6</td>
</tr>
<tr class="row-even"><td>3</td>
<td>Pattern Recognition</td>
<td>4</td>
</tr>
</tbody>
</table>
<p>By matching the value in the <code class="docutils literal"><span class="pre">author</span></code> column of the <code class="docutils literal"><span class="pre">books</span></code> table to the value in the <code class="docutils literal"><span class="pre">id</span></code> column of the <code class="docutils literal"><span class="pre">authors</span></code> table, you can see that Harry Houdini has two books belonging to him, while William Gibson only has one.</p>
</div>
<div class="section" id="relations-1-1">
<h3>Relations: 1 -&gt; 1<a class="headerlink" href="#relations-1-1" title="Permalink to this headline">¶</a></h3>
<p>One-to-one relationships are really just a special case of Many-to-one, and are also modelled with <em>Foreign Keys</em>.
In this case, the column on the related table which holds the <em>primary key</em> of the target table has an additional <em>unique</em> constraint
This means that only one row in the related table may contain a given  target primary id.
The classic purpose is for data that doesn&#8217;t need to be accessed often, and is unique per record.</p>
<p>Consider this example of birth records:</p>
<p><strong>People</strong>:</p>
<table border="1" class="docutils">
<colgroup>
<col width="11%" />
<col width="29%" />
<col width="32%" />
<col width="29%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">id</th>
<th class="head">username</th>
<th class="head">first_name</th>
<th class="head">last_name</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>1</td>
<td>wont_u_b</td>
<td>Fred</td>
<td>Rogers</td>
</tr>
<tr class="row-odd"><td>4</td>
<td>neuroman</td>
<td>William</td>
<td>Gibson</td>
</tr>
<tr class="row-even"><td>5</td>
<td>race</td>
<td>Roger</td>
<td>Bannon</td>
</tr>
</tbody>
</table>
<p><strong>Birth Records</strong>:</p>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="19%" />
<col width="38%" />
<col width="33%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">id</th>
<th class="head">person</th>
<th class="head">date</th>
<th class="head">place</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>1</td>
<td>1</td>
<td>March 20, 1928</td>
<td>Latrobe, PA</td>
</tr>
<tr class="row-odd"><td>2</td>
<td>4</td>
<td>March 17, 1948</td>
<td>Conway, SC</td>
</tr>
<tr class="row-even"><td>3</td>
<td>5</td>
<td>April 1, 1954</td>
<td>Wilmette, IL</td>
</tr>
</tbody>
</table>
<p>Each person is associated with one and only one birth record.
It wouldn&#8217;t make sense to have it otherwise.
And with a proper database like postgresql, adding a <em>unique</em> constraint to the <code class="docutils literal"><span class="pre">people</span></code> column of the <code class="docutils literal"><span class="pre">birth</span> <span class="pre">records</span></code> table means that if you try to create a second record with the same value as one already present, an error will be raised.
This concept is called <em>data integrity</em>, and some databases are better at preserving it than others.</p>
</div>
<div class="section" id="id1">
<h3>Relations: ∞ -&gt; ∞<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<p>Many-to-many relations are a bit trickier to model.
No column in a database can contain more than one value, so there&#8217;s no way to define a <em>foreign key</em>-like construct that would work.
Instead, this relationship is modelled using a third table, called a <em>join table</em>, which has two <em>foreign key</em> fields, one for each side of the relation.</p>
<p>Often such a <em>join table</em> will have only three columns, the primary key for a given row, and the two foreign keys that form the bridge between the joined entities.
But you can also add other columns to model data describing the qualities of the relationship itself.</p>
<p>Consider this set of tables, modelling the membership of people in groups:</p>
<p><strong>People</strong>:</p>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="31%" />
<col width="31%" />
<col width="28%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">id</th>
<th class="head">username</th>
<th class="head">first_name</th>
<th class="head">last_name</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>7</td>
<td>whitequeen</td>
<td>Emma</td>
<td>Frost</td>
</tr>
<tr class="row-odd"><td>8</td>
<td>shadowcat</td>
<td>Kitty</td>
<td>Pryde</td>
</tr>
</tbody>
</table>
<p><strong>Groups</strong>:</p>
<table border="1" class="docutils">
<colgroup>
<col width="21%" />
<col width="79%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">id</th>
<th class="head">name</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>1</td>
<td>Hellfire Club</td>
</tr>
<tr class="row-odd"><td>2</td>
<td>X-Men</td>
</tr>
</tbody>
</table>
<p><strong>Membership</strong>:</p>
<table border="1" class="docutils">
<colgroup>
<col width="15%" />
<col width="30%" />
<col width="26%" />
<col width="30%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">id</th>
<th class="head">person</th>
<th class="head">group</th>
<th class="head">active</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>1</td>
<td>7</td>
<td>1</td>
<td>False</td>
</tr>
<tr class="row-odd"><td>2</td>
<td>7</td>
<td>2</td>
<td>True</td>
</tr>
<tr class="row-even"><td>3</td>
<td>8</td>
<td>2</td>
<td>True</td>
</tr>
</tbody>
</table>
<p>The <code class="docutils literal"><span class="pre">membership</span></code> table forms the connection between a person and the groups they belong to.
By adding an <code class="docutils literal"><span class="pre">active</span></code> column to that table, it is possible to model the quality of a person&#8217;s membership in a group being <em>active</em> or <em>inactive</em>.
You might extend such a model, adding start and end dates or the names of positions held in a group by the person.</p>
</div>
</div>
<div class="section" id="sql-syntax">
<h2>SQL Syntax<a class="headerlink" href="#sql-syntax" title="Permalink to this headline">¶</a></h2>
<p>SQL is a formal language with a limited syntax.
The syntax can be broken into a set of <em>constructs</em>.
If you are familiar with these constructs, you can read an SQL statement and understand its purpose.
And you can write statements of your own to interact with the database.</p>
<ul class="simple">
<li><strong>Statements</strong> are discreet units that perform some action, like inserting records or querying</li>
<li><strong>Clauses</strong> are sub-units of statements which indicate some action or condition</li>
<li><strong>Expressions</strong> are elements that produce values, either unitary or as tables themselves</li>
<li><strong>Predicates</strong> are conditionals which produce some boolean or three-valued truth value</li>
</ul>
<div class="build container">
<a class="reference internal image-reference" href="../../_images/sql_anatomy.png"><img alt="../../_images/sql_anatomy.png" class="align-center" src="../../_images/sql_anatomy.png" style="width: 700px;" /></a>
<p>image: CC-BY-SA by Ferdna <a class="reference external" href="http://en.wikipedia.org/wiki/File:SQL_ANATOMY_wiki.svg">http://en.wikipedia.org/wiki/File:SQL_ANATOMY_wiki.svg</a></p>
</div>
<div class="section" id="subsets">
<h3>Subsets<a class="headerlink" href="#subsets" title="Permalink to this headline">¶</a></h3>
<p>All SQL statements can be thought of as belonging to one of three <em>subsets</em>:</p>
<dl class="docutils">
<dt>Data Definition:</dt>
<dd><p class="first">Statements in this subset concern the structure of the database itself</p>
<div class="highlight-sql"><div class="highlight"><pre><span class="k">CREATE</span> <span class="k">TABLE</span> <span class="ss">&quot;jos_groups&quot;</span> <span class="p">(</span>
  <span class="ss">&quot;group_id&quot;</span> <span class="nb">CHARACTER</span> <span class="nb">VARYING</span><span class="p">(</span><span class="mi">32</span><span class="p">)</span> <span class="k">NOT</span> <span class="k">NULL</span><span class="p">,</span>
  <span class="ss">&quot;name&quot;</span> <span class="nb">CHARACTER</span> <span class="nb">VARYING</span><span class="p">(</span><span class="mi">255</span><span class="p">)</span> <span class="k">NOT</span> <span class="k">NULL</span><span class="p">,</span>
  <span class="ss">&quot;description&quot;</span> <span class="nb">TEXT</span> <span class="k">NOT</span> <span class="k">NULL</span>
<span class="p">)</span>
</pre></div>
</div>
<p class="last">Common operations in this layer include <code class="docutils literal"><span class="pre">CREATE</span> <span class="pre">TABLE</span></code>, <code class="docutils literal"><span class="pre">ALTER</span> <span class="pre">TABLE</span></code>,
<code class="docutils literal"><span class="pre">DROP</span> <span class="pre">TABLE</span></code> and so on.</p>
</dd>
<dt>Data Manipulation:</dt>
<dd><p class="first">Statements in this subset concern the altering of data within the database</p>
<div class="highlight-sql"><div class="highlight"><pre><span class="k">INSERT</span>
    <span class="k">INTO</span> <span class="n">people</span> <span class="p">(</span><span class="n">username</span><span class="p">,</span> <span class="n">first_name</span><span class="p">,</span> <span class="n">lastname</span><span class="p">)</span>
    <span class="k">VALUES</span> <span class="p">(</span><span class="s1">&#39;wont_u_b&#39;</span><span class="p">,</span> <span class="s1">&#39;Fred&#39;</span><span class="p">,</span> <span class="s1">&#39;Rogers&#39;</span><span class="p">)</span>

<span class="k">UPDATE</span> <span class="n">people</span>
    <span class="k">SET</span> <span class="n">first_name</span><span class="o">=</span><span class="s1">&#39;Bill&#39;</span>
    <span class="k">WHERE</span> <span class="n">id</span><span class="o">=</span><span class="mi">4</span><span class="p">;</span>

<span class="k">DELETE</span> <span class="k">FROM</span> <span class="n">people</span>
    <span class="k">WHERE</span> <span class="n">id</span><span class="o">=</span><span class="mi">6</span><span class="p">;</span>
</pre></div>
</div>
<p class="last">Common operations in this layer include <code class="docutils literal"><span class="pre">INSERT</span></code>, <code class="docutils literal"><span class="pre">UPDATE</span></code> and <code class="docutils literal"><span class="pre">DELETE</span></code>.</p>
</dd>
<dt>Data Query:</dt>
<dd><p class="first">Statements in this subset concern the retrieval of data from within the database:</p>
<div class="highlight-psql"><div class="highlight"><pre><span class="k">SELECT</span> <span class="n">user_id</span><span class="p">,</span> <span class="n">COUNT</span><span class="p">(</span><span class="o">*</span><span class="p">)</span> <span class="n">c</span>
  <span class="k">FROM</span> <span class="p">(</span><span class="k">SELECT</span> <span class="n">setting_value</span> <span class="k">AS</span> <span class="n">interests</span><span class="p">,</span> <span class="n">user_id</span>
          <span class="k">FROM</span> <span class="n">user_settings</span>
          <span class="k">WHERE</span> <span class="n">setting_name</span> <span class="o">=</span> <span class="s1">&#39;interests&#39;</span><span class="p">)</span> <span class="n">raw_uid</span>
  <span class="k">GROUP</span> <span class="k">BY</span> <span class="n">user_id</span> <span class="k">HAVING</span> <span class="n">c</span> <span class="o">&gt;</span> <span class="mf">1</span><span class="p">;</span>
</pre></div>
</div>
<p class="last"><code class="docutils literal"><span class="pre">SELECT</span></code> is the only operation in this layer.</p>
</dd>
</dl>
<p>If you wish to learn more about SQL, you could run through <a class="reference external" href="http://www.postgresqltutorial.com/">this tutorial</a> or any of a large number of others online.
But for now, that will be sufficient for your current purposes.</p>
</div>
</div>
<div class="section" id="sql-persistence-in-python">
<h2>SQL Persistence in Python<a class="headerlink" href="#sql-persistence-in-python" title="Permalink to this headline">¶</a></h2>
<p>In Python, <span class="target" id="index-0"></span><a class="pep reference external" href="https://www.python.org/dev/peps/pep-0249"><strong>PEP 249</strong></a> describes a common API for interacting with a database called DB-API 2.</p>
<p>The goal was to</p>
<blockquote>
<div>achieve a consistency leading to more easily understood modules, code
that is generally more portable across databases, and a broader reach
of database connectivity from Python</div></blockquote>
<p>source: <a class="reference external" href="http://www.python.org/dev/peps/pep-0248/">http://www.python.org/dev/peps/pep-0248/</a></p>
<p>It is important to remember that PEP 249 is <strong>only a specification</strong>.
There is no code or package for DB-API 2 on it&#8217;s own.</p>
<p>Since 2.5, the Python Standard Library has provided a <a class="reference external" href="http://docs.python.org/2/library/sqlite3.html#module-sqlite3" title="(in Python v2.7)"><code class="xref py py-mod docutils literal"><span class="pre">reference</span> <span class="pre">implementation</span> <span class="pre">of</span> <span class="pre">the</span> <span class="pre">api</span></code></a> (<a class="reference external" href="http://docs.python.org/3/library/sqlite3.html#module-sqlite3" title="(in Python v3.6)"><code class="xref py py-mod docutils literal"><span class="pre">py3</span></code></a>) based on SQLite3.
Before Python 2.5, this package was available as <code class="docutils literal"><span class="pre">pysqlite</span></code>.</p>
<p>To use the DB API with any database other than SQLite3, you must have an underlying API package available.
Implementations are available for:</p>
<ul class="simple">
<li>PostgreSQL (<strong>psycopg2</strong>, txpostgres, ...)</li>
<li>MySQL (<strong>mysql-python</strong>, PyMySQL, ...)</li>
<li>MS SQL Server (<strong>adodbapi</strong>, pymssql, mxODBC, pyodbc, ...)</li>
<li>Oracle (<strong>cx_Oracle</strong>, mxODBC, pyodbc, ...)</li>
<li>and many more...</li>
</ul>
<p>source: <a class="reference external" href="http://wiki.python.org/moin/DatabaseInterfaces">http://wiki.python.org/moin/DatabaseInterfaces</a></p>
<p>Most db api packages can be installed using typical Pythonic methods:</p>
<div class="highlight-python"><div class="highlight"><pre>$ pip install psycopg2
$ pip install mysql-python
...
</pre></div>
</div>
<p>However, most api packages will require that the development headers for the underlying database system be available.
Without these, the C symbols required for communication with the db are not present and the wrapper cannot work.</p>
<div class="section" id="preprarations-for-class">
<h3>Preprarations for Class<a class="headerlink" href="#preprarations-for-class" title="Permalink to this headline">¶</a></h3>
<p>In class we will be exploring interacting with a database using raw SQL and a more advanced concept called an <code class="docutils literal"><span class="pre">ORM</span></code> or Object-Relational Mapper.</p>
<div class="section" id="install-postgresql">
<h4>Install PostgreSQL<a class="headerlink" href="#install-postgresql" title="Permalink to this headline">¶</a></h4>
<p>The first step in working with PostgreSQL (or any other RDBMS) is to install the database software.</p>
<p>If you are using <strong>OS X</strong>, please follow <a class="reference external" href="http://exponential.io/blog/2015/02/21/install-postgresql-on-mac-os-x-via-brew/">these steps</a> to install PostgreSQL via <a class="reference external" href="http://brew.sh/">homebrew</a>.</p>
<p>If you are using <strong>ubuntu linux</strong>, please follow <a class="reference external" href="https://www.digitalocean.com/community/tutorials/how-to-install-and-use-postgresql-on-ubuntu-14-04">these instructions</a>. Stop after the section <code class="docutils literal"><span class="pre">Create</span> <span class="pre">a</span> <span class="pre">New</span> <span class="pre">Role</span></code> (make a role with the same name as your login user).</p>
<p>If you are using <strong>windows</strong>, follow <a class="reference external" href="http://www.postgresqltutorial.com/install-postgresql/">the steps here</a>.</p>
</div>
<div class="section" id="create-a-database">
<h4>Create a Database<a class="headerlink" href="#create-a-database" title="Permalink to this headline">¶</a></h4>
<p>The second step is to create a database.
Installing the PostgreSQL Software initializes the database system, but does not create a database for you to use.
You must do this manually.</p>
<p>There are two ways to accomplish this. For most, the best way is to use the <code class="docutils literal"><span class="pre">createdb</span></code> shell command:</p>
<div class="highlight-bash"><div class="highlight"><pre>$ createdb psycotest
</pre></div>
</div>
<p>If you are using <strong>windows</strong> you&#8217;ll instead need to <a class="reference external" href="http://www.postgresqltutorial.com/connect-to-postgresql-database/">connect to the database with psql</a> and use the <code class="docutils literal"><span class="pre">CREATE</span> <span class="pre">DATABASE</span></code> command from there:</p>
<div class="highlight-psql"><div class="highlight"><pre><span class="gp">cewing=#</span> <span class="k">CREATE</span> <span class="k">DATABASE</span> <span class="n">psycotest</span>
</pre></div>
</div>
<p>You can <a class="reference external" href="http://www.postgresql.org/docs/current/static/manage-ag-createdb.html">read more about creating a database</a> in the PostgreSQL documentation.</p>
<p>This will create a database called <cite>psycotest</cite> owned by the <em>role</em> within PostgreSQL with the same name as your current OS user.
In class we&#8217;ll use this database to test out interacting via Python.</p>
<p>Check to be sure that the database is now present, using the psql command:</p>
<div class="highlight-bash"><div class="highlight"><pre>heffalump:psycopg2 cewing$ psql
psql <span class="o">(</span>9.3.2<span class="o">)</span>
Type <span class="s2">&quot;help&quot;</span> <span class="k">for</span> help.
</pre></div>
</div>
<p>Once connected you can list the databases in your server instance:</p>
<div class="highlight-psql"><div class="highlight"><pre><span class="gp">cewing=#</span> <span class="kp">\d</span>
<span class="go">No relations found.</span>
<span class="gp">cewing=#</span> <span class="kp">\l</span>
<span class="go">                                List of databases</span>
<span class="go">    Name     | Owner  | Encoding |   Collate   |    Ctype    | Access privileges</span>
<span class="go">-------------+--------+----------+-------------+-------------+-------------------</span>
<span class="go"> cewing      | cewing | UTF8     | en_US.UTF-8 | en_US.UTF-8 |</span>
<span class="go"> dvdrental   | cewing | UTF8     | en_US.UTF-8 | en_US.UTF-8 |</span>
<span class="go"> postgres    | cewing | UTF8     | en_US.UTF-8 | en_US.UTF-8 |</span>
<span class="go"> psycotest   | cewing | UTF8     | en_US.UTF-8 | en_US.UTF-8 |</span>
<span class="go"> template0   | cewing | UTF8     | en_US.UTF-8 | en_US.UTF-8 | =c/cewing        +</span>
<span class="go">             |        |          |             |             | cewing=CTc/cewing</span>
<span class="go"> template1   | cewing | UTF8     | en_US.UTF-8 | en_US.UTF-8 | =c/cewing        +</span>
<span class="go">             |        |          |             |             | cewing=CTc/cewing</span>
<span class="go">(7 rows)</span>
</pre></div>
</div>
<p>You won&#8217;t have a list so long, but you should see <code class="docutils literal"><span class="pre">psycotest</span></code> listed.</p>
<p>The <code class="docutils literal"><span class="pre">psql</span></code> command opens an interactive shell in PostgreSQL (similar to the Python interpreter).
While you are in this shell you are working directly in the database system.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">If you do not designate a specific database with the <code class="docutils literal"><span class="pre">-d</span></code> flag when connecting, you will be connected to a database with the same name as the user who is connecting.
If no such database exists, then psql will fail to start.</p>
</div>
<p>Once the psql shell starts, you can simply type SQL commands directly into it.
Your commands will be executed in the database to which you are connected.
The psql shell provides a number of other, special commands.
In the session above we can see some of them:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">\l</span></code> lists all the databases present in the server.</li>
<li><code class="docutils literal"><span class="pre">\c</span></code> allows you to change the database you are interacting with.
Give it a database name as an argument.</li>
<li><code class="docutils literal"><span class="pre">\d</span></code> describes the tables in a database.
It can also take the name of one table as an argument, in which case it describes the columns in that table.</li>
<li><code class="docutils literal"><span class="pre">\q</span></code> exits from the terminal and returns you to your normal shell session.</li>
</ul>
<p>There is <a class="reference external" href="http://www.postgresql.org/docs/current/static/app-psql.html">much more to learn about psql</a> but that will get you going for now.</p>
</div>
<div class="section" id="create-tables">
<h4>Create Tables<a class="headerlink" href="#create-tables" title="Permalink to this headline">¶</a></h4>
<p>A database is nothing without tables, so we need to create some.</p>
<p>The set of SQL commands that create and modify tables within a database is
called the <strong>Data Definition Layer</strong>.</p>
<p>We&#8217;ll create a simple two-table database to play with in class.</p>
<p>At your psql command prompt, change the database you are interacting with to the <code class="docutils literal"><span class="pre">psycotest</span></code> one you created above:</p>
<div class="highlight-psql"><div class="highlight"><pre><span class="gp">cewing=#</span> <span class="kp">\c</span> <span class="ss">psycotest</span>
<span class="go">You are now connected to database &quot;psycotest&quot; as user &quot;cewing&quot;.</span>
<span class="gp">psycotest=#</span>
</pre></div>
</div>
<p>Next, type the following SQL commands at the prompt.
You can press enter to get newlines that match, psql will not evaluate what you have typed <em>until you use a semi-colon</em> to terminate the statement:</p>
<div class="highlight-psql"><div class="highlight"><pre><span class="gp">psycotest=#</span> <span class="k">CREATE</span> <span class="k">TABLE</span> <span class="n">author</span><span class="p">(</span>
<span class="gp">psycotest(#</span>   <span class="n">authorid</span> <span class="nb">serial</span> <span class="k">PRIMARY</span> <span class="k">KEY</span><span class="p">,</span>
<span class="gp">psycotest(#</span>   <span class="k">name</span> <span class="nb">varchar</span> <span class="p">(</span><span class="mf">255</span><span class="p">)</span> <span class="k">NOT</span> <span class="k">NULL</span>
<span class="gp">psycotest(#</span> <span class="p">);</span>
<span class="go">CREATE TABLE</span>
<span class="gp">psycotest=#</span> <span class="k">CREATE</span> <span class="k">TABLE</span> <span class="n">book</span><span class="p">(</span>
<span class="gp">psycotest(#</span>   <span class="n">bookid</span> <span class="nb">serial</span> <span class="k">PRIMARY</span> <span class="k">KEY</span><span class="p">,</span>
<span class="gp">psycotest(#</span>   <span class="n">title</span> <span class="nb">varchar</span> <span class="p">(</span><span class="mf">255</span><span class="p">)</span> <span class="k">NOT</span> <span class="k">NULL</span><span class="p">,</span>
<span class="gp">psycotest(#</span>   <span class="n">authorid</span> <span class="nb">INTEGER</span> <span class="k">REFERENCES</span> <span class="n">author</span> <span class="k">ON</span> <span class="k">UPDATE</span> <span class="k">NO</span> <span class="k">ACTION</span> <span class="k">ON</span> <span class="k">DELETE</span> <span class="k">NO</span> <span class="k">ACTION</span>
<span class="gp">psycotest(#</span> <span class="p">);</span>
<span class="go">CREATE TABLE</span>
<span class="gp">psycotest=#</span>
</pre></div>
</div>
<p>Now, when you use the <code class="docutils literal"><span class="pre">\d</span></code> command to show the tables in this database, you should see the two you just created:</p>
<div class="highlight-psql"><div class="highlight"><pre><span class="gp">psycotest=#</span> <span class="kp">\d</span>
<span class="go">                List of relations</span>
<span class="go"> Schema |        Name         |   Type   | Owner</span>
<span class="go">--------+---------------------+----------+--------</span>
<span class="go"> public | author              | table    | cewing</span>
<span class="go"> public | author_authorid_seq | sequence | cewing</span>
<span class="go"> public | book                | table    | cewing</span>
<span class="go"> public | book_bookid_seq     | sequence | cewing</span>
<span class="go">(4 rows)</span>

<span class="gp">psycotest=#</span>
</pre></div>
</div>
<p>Notice that there are actually 4 <em>relations</em>.
The two tables you created and two <em>sequences</em> with names that match our primary keys.
These relations are how PostgreSQL generates sequential integers to serve as primary keys.
When a new row is created in one of the tables, the next value in the sequence is used as the value of the primary key for that row.</p>
<p>Each table then has a set of <code class="docutils literal"><span class="pre">columns</span></code>.
These columns define the types of data that the table is concerned with.</p>
<p>In both tables we have a <code class="docutils literal"><span class="pre">PRIMARY</span> <span class="pre">KEY</span></code> column.
This column is used to identify rows in the database and must contain unique values.
The data type <code class="docutils literal"><span class="pre">serial</span></code> helps to ensure this as it automatically assigns integer values starting with 1 and counting upwards.</p>
<p>In both tables we also have a column containing <code class="docutils literal"><span class="pre">VARCHAR</span></code> data.
This type requires that we designate the maximum size of the data that will be held here.
Each of these columns is marked as <code class="docutils literal"><span class="pre">NOT</span> <span class="pre">NULL</span></code>, meaning that a value is required.</p>
<p>Finally, in the <code class="docutils literal"><span class="pre">book</span></code> table there is an <code class="docutils literal"><span class="pre">INTEGER</span></code> column which <code class="docutils literal"><span class="pre">REFERENCES</span></code> a column in the other table.
This creates a <em>Foreign Key</em> relationship between the two tables.</p>
<p>Relationships such as this are central to SQL databases and are the reason such systems are called <strong>RDBMSs</strong>, or Relational Database Management Systems.</p>
<p>Using the <code class="docutils literal"><span class="pre">\d</span></code> command with a table name argument, you can see the description of each of the tables you&#8217;ve created:</p>
<div class="highlight-psql"><div class="highlight"><pre><span class="gp">psycotest=#</span> <span class="kp">\d</span> <span class="ss">author</span>
<span class="go">                                     Table &quot;public.author&quot;</span>
<span class="go">  Column  |          Type          |                         Modifiers</span>
<span class="go">----------+------------------------+-----------------------------------------------------------</span>
<span class="go"> authorid | integer                | not null default nextval(&#39;author_authorid_seq&#39;::regclass)</span>
<span class="go"> name     | character varying(255) | not null</span>
<span class="go">Indexes:</span>
<span class="go">    &quot;author_pkey&quot; PRIMARY KEY, btree (authorid)</span>
<span class="go">Referenced by:</span>
<span class="go">    TABLE &quot;book&quot; CONSTRAINT &quot;book_authorid_fkey&quot; FOREIGN KEY (authorid) REFERENCES author(authorid)</span>

<span class="gp">psycotest=#</span> <span class="kp">\d</span> <span class="ss">book</span>
<span class="go">                                    Table &quot;public.book&quot;</span>
<span class="go">  Column  |          Type          |                       Modifiers</span>
<span class="go">----------+------------------------+-------------------------------------------------------</span>
<span class="go"> bookid   | integer                | not null default nextval(&#39;book_bookid_seq&#39;::regclass)</span>
<span class="go"> title    | character varying(255) | not null</span>
<span class="go"> authorid | integer                |</span>
<span class="go">Indexes:</span>
<span class="go">    &quot;book_pkey&quot; PRIMARY KEY, btree (bookid)</span>
<span class="go">Foreign-key constraints:</span>
<span class="go">    &quot;book_authorid_fkey&quot; FOREIGN KEY (authorid) REFERENCES author(authorid)</span>
</pre></div>
</div>
<p>Go ahead and quit the psql shell, using the <code class="docutils literal"><span class="pre">\q</span></code> command:</p>
<div class="highlight-psql"><div class="highlight"><pre><span class="gp">psycotest=#</span> <span class="kp">\q</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="working-environment">
<h3>Working Environment<a class="headerlink" href="#working-environment" title="Permalink to this headline">¶</a></h3>
<p>In class you&#8217;ll want to have a nice test environment available to work in.
Your final task is to set that up.</p>
<p>Create a folder to work in:</p>
<div class="highlight-bash"><div class="highlight"><pre>Banks:~ cewing$ mkdir psycopg2
</pre></div>
</div>
<p>Then create and activate a virtualenv in that directory:</p>
<div class="highlight-bash"><div class="highlight"><pre>Banks:~ cewing$ <span class="nb">cd</span> psycopg2
Banks:~ cewing$ virtualenv ./
New python executable in psycopg2/bin/python
...
Banks:psycopg2 cewing$ <span class="nb">source</span> bin/activate
<span class="o">[</span>psycopg2<span class="o">]</span>
Banks:psycopg2 cewing$
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">If you run into errors building psycopg2 on Ubuntu/Debian linux that say <code class="docutils literal"><span class="pre">Error:</span> <span class="pre">pg_config</span> <span class="pre">executable</span> <span class="pre">not</span> <span class="pre">found</span></code>, you&#8217;ll want to check out <a class="reference external" href="http://stackoverflow.com/questions/5420789/how-to-install-psycopg2-with-pip-on-python">this question</a> on stack overflow.</p>
</div>
<p>Now that you&#8217;ve got the environment set up, and a project folder to work in, go ahead and install the software you&#8217;ll need for class:</p>
<div class="highlight-bash"><div class="highlight"><pre>Banks:psycopg cewing$ pip install psycopg2
Collecting psycopg2
  ...
  Running setup.py install <span class="k">for</span> psycopg2
Successfully installed psycopg2-2.6.1
<span class="o">[</span>psycopg<span class="o">]</span>
Banks:psycopg cewing$ pip install sqlalchemy
Collecting sqlalchemy
  ...
  Running setup.py install <span class="k">for</span> sqlalchemy
Successfully installed sqlalchemy-1.0.12
<span class="o">[</span>psycopg<span class="o">]</span>
Banks:psycopg cewing$
</pre></div>
</div>
<p>Once that&#8217;s successfully done, you are ready for class.</p>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Introduction to SQL</a><ul>
<li><a class="reference internal" href="#what-is-sql">What is SQL</a><ul>
<li><a class="reference internal" href="#big-players-in-sql">Big Players in SQL</a></li>
</ul>
</li>
<li><a class="reference internal" href="#sql-rdbms-concepts">SQL/RDBMS Concepts</a><ul>
<li><a class="reference internal" href="#tables">Tables</a></li>
<li><a class="reference internal" href="#relations">Relations</a></li>
<li><a class="reference internal" href="#relations-1">Relations: ∞ -&gt; 1</a></li>
<li><a class="reference internal" href="#relations-1-1">Relations: 1 -&gt; 1</a></li>
<li><a class="reference internal" href="#id1">Relations: ∞ -&gt; ∞</a></li>
</ul>
</li>
<li><a class="reference internal" href="#sql-syntax">SQL Syntax</a><ul>
<li><a class="reference internal" href="#subsets">Subsets</a></li>
</ul>
</li>
<li><a class="reference internal" href="#sql-persistence-in-python">SQL Persistence in Python</a><ul>
<li><a class="reference internal" href="#preprarations-for-class">Preprarations for Class</a><ul>
<li><a class="reference internal" href="#install-postgresql">Install PostgreSQL</a></li>
<li><a class="reference internal" href="#create-a-database">Create a Database</a></li>
<li><a class="reference internal" href="#create-tables">Create Tables</a></li>
</ul>
</li>
<li><a class="reference internal" href="#working-environment">Working Environment</a></li>
</ul>
</li>
</ul>
</li>
</ul>

<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="nav-item nav-item-0"><a href="../../index.html">Python 401 2.1 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &copy; Copyright 2014-2016, Cris Ewing, Nicholas Hunt-Walker.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.3.5.
    </div>
  </body>
</html>