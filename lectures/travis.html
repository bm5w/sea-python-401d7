<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Automate Tests with Travis CI &mdash; Python 401 2.1 documentation</title>
    
    <link rel="stylesheet" href="../_static/pyramid.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '2.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="top" title="Python 401 2.1 documentation" href="../index.html" />
<link rel="stylesheet" href="http://fonts.googleapis.com/css?family=Neuton&amp;subset=latin" type="text/css" media="screen" charset="utf-8" />
<link rel="stylesheet" href="http://fonts.googleapis.com/css?family=Nobile:regular,italic,bold,bolditalic&amp;subset=latin" type="text/css" media="screen" charset="utf-8" />

<link rel="stylesheet" href="../_static/custom.css" type="text/css" media="screen" charset="utf-8" />

<!--[if lte IE 6]>
<link rel="stylesheet" href="../_static/ie6.css" type="text/css" media="screen" charset="utf-8" />
<![endif]-->

  </head>
  <body role="document">
<div class="header">
  <div class="logo">
    <a href="../index.html">
      <img class="logo" src="../_static/cf_logo.png" alt="Logo"/>
      <p>Code Fellows</p>
    </a>
  </div>
</div>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="nav-item nav-item-0"><a href="../index.html">Python 401 2.1 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput,
div.nbinput > div,
div.nbinput div[class^=highlight],
div.nbinput div[class^=highlight] pre,
div.nboutput,
div.nboutput > div,
div.nboutput div[class^=highlight],
div.nboutput div[class^=highlight] pre {
    background: none;
    border: none;
    padding: 0 0;
    margin: 0;
    box-shadow: none;
}

/* input/output containers */
div.nbinput,
div.nboutput {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
}

/* input container */
div.nbinput {
    padding-top: 5px;
}

/* last container */
div.nblast {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput > :first-child pre {
    color: navy;
}

/* output prompt */
div.nboutput > :first-child pre {
    color: darkred;
}

/* all prompts */
div.nbinput > :first-child[class^=highlight],
div.nboutput > :first-child[class^=highlight],
div.nboutput > :first-child {
    min-width: 11ex;
    padding-top: 0.4em;
    padding-right: 0.4em;
    text-align: right;
    flex: 0;
}

/* input/output area */
div.nbinput > :nth-child(2)[class^=highlight],
div.nboutput > :nth-child(2),
div.nboutput > :nth-child(2)[class^=highlight] {
    padding: 0.4em;
    -webkit-flex: 1;
    flex: 1;
}

/* input area */
div.nbinput > :nth-child(2)[class^=highlight] {
    border: 1px solid #cfcfcf;
    border-radius: 2px;
    background: #f7f7f7;
}

/* override MathJax center alignment in output cells */
div.nboutput div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.pngmath center alignment in output cells */
div.nboutput div.math p {
    text-align: left;
}

/* standard error */
div.nboutput  > :nth-child(2).stderr {
    background: #fdd;
}

/* ANSI colors */
.ansiblack { color: black; }
.ansired { color: darkred; }
.ansigreen { color: darkgreen; }
.ansiyellow { color: #c4a000; }
.ansiblue { color: darkblue; }
.ansipurple { color: darkviolet; }
.ansicyan { color: steelblue; }
/* See https://github.com/jupyter/nbconvert/issues/174 */
.ansigray { color: gray; }  /* nbconvert CSS */
.ansigrey { color: gray; }  /* nbconvert HTML output */

.ansibgblack { background-color: black; }
.ansibgred { background-color: red; }
.ansibggreen { background-color: green; }
.ansibgyellow { background-color: yellow; }
.ansibgblue { background-color: blue; }
.ansibgpurple { background-color: magenta; }
.ansibgcyan { background-color: cyan; }
.ansibggray { background-color: gray; }

.ansibold { font-weight: bold; }
</style>
<div class="section" id="automate-tests-with-travis-ci">
<h1>Automate Tests with Travis CI<a class="headerlink" href="#automate-tests-with-travis-ci" title="Permalink to this headline">¶</a></h1>
<p>Tests are great.
They prove that your code works the way you advertise it to work.
But the best tests in the world are no good unless you actually run them.</p>
<p>Do you run your tests before checking in code?</p>
<p>Every time?</p>
<p>Yeah, I don&#8217;t either.</p>
<p>It&#8217;s hard to remember to run your tests every time.
Even in the real world, teams run into trouble when they fail to run tests before checking in changes.
So give up the <em>manual</em> testing and reach for <strong>automation</strong>, the savior of us all.</p>
<div class="section" id="automation-to-the-rescue">
<h2>Automation to the Rescue<a class="headerlink" href="#automation-to-the-rescue" title="Permalink to this headline">¶</a></h2>
<p>Allow your repository to run your tests for you.</p>
<p>GitHub provides simple integration with <a class="reference external" href="https://travis-ci.org/.">a service called Travis CI</a>.</p>
<p>Travis leverages the power of <a class="reference external" href="http://jenkins-ci.org">an automated build tool called Jenkins</a>.
This tool allows you to configure <em>jobs</em> that can involve pretty much all aspects of setting up software, including running tests.</p>
<p>You can download and install <code class="docutils literal"><span class="pre">Jenkins</span></code> on your own, but unless you are a development team with complex needs, it&#8217;s probably overkill to do so.
<code class="docutils literal"><span class="pre">Travis</span> <span class="pre">CI</span></code> provides access to the test-running capabilities of <code class="docutils literal"><span class="pre">Jenkins</span></code> with a minimum of fuss and difficulty.</p>
<div class="section" id="getting-started">
<h3>Getting Started<a class="headerlink" href="#getting-started" title="Permalink to this headline">¶</a></h3>
<p>So long as your project <em>has tests</em> that can be run with a command, Travis is great for you.
Let&#8217;s start with a simple example, a <a class="reference external" href="https://github.com/nhuntwalker/fizzbuzz">FizzBuzz repository</a>.
You can fork and clone your own copy if you&#8217;d like to play along.</p>
<p>The first step is to <a class="reference external" href="https://travis-ci.org.">sign in to Travis</a>.
Luckily, you can simply sign in using the account you already have with GitHub (no new account required!).</p>
<div class="figure align-center" id="id4">
<a class="reference internal image-reference" href="../_images/sign_in_to_github.png"><img alt="../_images/sign_in_to_github.png" src="../_images/sign_in_to_github.png" style="width: 48%;" /></a>
<p class="caption"><span class="caption-text"><em>Travis will request rights to your repository</em></span></p>
</div>
<p>You&#8217;ll need to authorize Travis to allow it to access your repositories.</p>
<div class="figure align-center" id="id5">
<a class="reference internal image-reference" href="../_images/help_docs.png"><img alt="../_images/help_docs.png" src="../_images/help_docs.png" style="width: 75%;" /></a>
<p class="caption"><span class="caption-text"><em>The docs link is found under the Help tab</em></span></p>
</div>
<p class="left">Once you&#8217;ve signed in, click on the <em>Help</em> &gt; <em>docs</em> link in the top and then click the big red <em>Get Started</em> button.</p>
<div class="figure align-center" id="id6">
<a class="reference internal image-reference" href="../_images/link_to_profile.png"><img alt="../_images/link_to_profile.png" src="../_images/link_to_profile.png" style="width: 75%;" /></a>
<p class="caption"><span class="caption-text"><em>profile page link</em></span></p>
</div>
<p class="left">The steps that are outlined on that page will tell you to go to your <strong>profile page</strong>.
The link there is the easiest way to do so.
Click it.</p>
<div class="figure" id="id7">
<a class="reference internal image-reference" href="../_images/project_list.png"><img alt="../_images/project_list.png" src="../_images/project_list.png" style="width: 43%;" /></a>
<p class="caption"><span class="caption-text"><em>The repository list in TravisCI</em></span></p>
</div>
<p class="left">When the page loads, it will contain a list of all the repositories that you have in your <code class="docutils literal"><span class="pre">GitHub</span></code> account.
For each, there is an on/off switch.
Find your fizzbuzz repository and turn it on.</p>
<p>Once this is done, you need to let <code class="docutils literal"><span class="pre">GitHub</span></code> know that you want <code class="docutils literal"><span class="pre">Travis</span> <span class="pre">CI</span></code> to have access to your repositories.
You do this by enabling the <strong>Travis Commit Hook</strong>.</p>
<p>In <code class="docutils literal"><span class="pre">GitHub</span></code>, find and enter your <code class="docutils literal"><span class="pre">fizzbuzz</span></code> repository.
Find and click on the <code class="docutils literal"><span class="pre">Settings</span></code> tab.
On the left menu, click on the <code class="docutils literal"><span class="pre">Integrations</span> <span class="pre">&amp;</span> <span class="pre">services</span></code> menu item.</p>
<p>Check first to see if <em>Travis CI</em> is already listed in the <em>Services</em> pane on that page.
If so you can skip to <a class="reference internal" href="#configuring-travis"><span>Configuring Travis</span></a> below.</p>
<p>If not, you want to configure a third-party service.
Click on the <em>Add service</em> button and find the <strong>Travis CI</strong> service in the long, alphabetical list.
Click it to open the settings for <code class="docutils literal"><span class="pre">Travis</span> <span class="pre">CI</span></code> (it&#8217;ll ask for you to log in).</p>
<p>You can configure a number of options, but to get started all you <em>have to</em> provide is your <strong>Travis Token</strong>.
You can get this from your <code class="docutils literal"><span class="pre">Travis</span> <span class="pre">CI</span></code> profile page by clicking on your username at the Travis CI website.
Paste it in the provided text box.
You don&#8217;t need to provide the &#8220;Domain&#8221; field.</p>
<p>After you&#8217;ve pasted your token, check the <cite>active</cite> box, then click <em>Update settings</em>.</p>
</div>
</div>
<div class="section" id="configuring-travis">
<span id="id1"></span><h2>Configuring Travis<a class="headerlink" href="#configuring-travis" title="Permalink to this headline">¶</a></h2>
<p><code class="docutils literal"><span class="pre">Travis</span> <span class="pre">CI</span></code> needs to know how <em>your</em> tests should be run.
It does this using a configuration file written in <a class="reference external" href="http://www.yaml.org">YAML</a>.</p>
<p>For a Python project there are a couple of things to set up:</p>
<ul class="simple">
<li>You must inform Travis that your project uses Python.</li>
<li>You must inform Travis which versions of Python are used.</li>
<li>You must inform Travis what command to run to execute your tests.</li>
<li>You can tell Travis what extra software needs to be installed.</li>
</ul>
<p>For the <code class="docutils literal"><span class="pre">fizzbuzz</span></code> project, we want to test in Python 2.7 and 3.6.
We&#8217;ll also need to provide teh command to be executed in order to run our tests.</p>
<p>Here&#8217;s what the <code class="docutils literal"><span class="pre">YAML</span></code> file will look like:</p>
<div class="highlight-yaml"><div class="highlight"><pre><span class="l l-Scalar l-Scalar-Plain">language</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">python</span>
<span class="l l-Scalar l-Scalar-Plain">python</span><span class="p p-Indicator">:</span>
  <span class="p p-Indicator">-</span> <span class="s">&quot;2.7&quot;</span>
  <span class="p p-Indicator">-</span> <span class="s">&quot;3.6&quot;</span>
<span class="c1"># command to install dependencies</span>
<span class="l l-Scalar l-Scalar-Plain">install</span><span class="p p-Indicator">:</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">pip install .</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">pip install -r requirements.txt</span>
<span class="c1"># command to run tests</span>
<span class="l l-Scalar l-Scalar-Plain">script</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">py.test</span>
</pre></div>
</div>
<p>Formatting is important, in particular for list entries like <code class="docutils literal"><span class="pre">python:</span></code>.</p>
<p>To set this up, we need to add a new file to our <code class="docutils literal"><span class="pre">fizzbuzz</span></code> repository with that content.</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="o">(</span>ENV<span class="o">)</span> $ <span class="nb">pwd</span>
/Users/Nick/Documents/codefellows/courses/exercises/fizzbuzz

<span class="o">(</span>ENV<span class="o">)</span> $ touch .travis.yml

<span class="o">(</span>ENV<span class="o">)</span> $ subl .travis.yml
</pre></div>
</div>
<p>Once you&#8217;ve entered the above content into <code class="docutils literal"><span class="pre">.travis.yml</span></code>, you&#8217;re nearly there.
You&#8217;ve told <code class="docutils literal"><span class="pre">Travis</span> <span class="pre">CI</span></code> what it will need to build your project and test it.
But there&#8217;s still one thing missing, <a href="#id2"><span class="problematic" id="id3">**</span></a>requirements.txt``.</p>
<div class="section" id="installing-python-packages">
<h3>Installing Python Packages<a class="headerlink" href="#installing-python-packages" title="Permalink to this headline">¶</a></h3>
<p>When we create a <code class="docutils literal"><span class="pre">virtualenv</span></code> for the <code class="docutils literal"><span class="pre">fizzbuzz</span></code> project, we need to install our package and our package&#8217;s dependencies.
<code class="docutils literal"><span class="pre">pip</span></code> can also be automated to a degree by...</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">pip</span> <span class="pre">install</span> <span class="pre">.</span></code></li>
<li><code class="docutils literal"><span class="pre">pip</span> <span class="pre">install</span> <span class="pre">-r</span> <span class="pre">requirements.txt</span></code></li>
</ul>
</div>
<div class="section" id="running-your-ci-tests">
<h3>Running Your CI Tests<a class="headerlink" href="#running-your-ci-tests" title="Permalink to this headline">¶</a></h3>
<p>Now that you have all the pieces in place, you should be ready to roll.
Add the two new files you&#8217;ve created to your <code class="docutils literal"><span class="pre">fizzbuzz</span></code> repository, commit, and push.</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="o">(</span>ENV<span class="o">)</span> $ git add .travis.yml requirements.txt

<span class="o">(</span>ENV<span class="o">)</span> $ git commit -m <span class="s2">&quot;Adding Travis CI integration&quot;</span>

<span class="o">(</span>ENV<span class="o">)</span> $ git push origin master
</pre></div>
</div>
<p>If all is well, you should be able to look at your main page in <code class="docutils literal"><span class="pre">Travis</span> <span class="pre">CI</span></code> and see your tests start, run, and pass.</p>
</div>
<div class="section" id="advertise-your-awesomeness">
<h3>Advertise Your Awesomeness<a class="headerlink" href="#advertise-your-awesomeness" title="Permalink to this headline">¶</a></h3>
<p>Now that you&#8217;ve got Travis CI running and you have your tests passing, let the world know about it.</p>
<p>On the Travis page for this repository, click on the image next to the <code class="docutils literal"><span class="pre">GitHub</span></code> icon that says (probably for you) <code class="docutils literal"><span class="pre">build</span> <span class="pre">unknown</span></code>.</p>
<p>A small window will pop up for you to copy the image for the <code class="docutils literal"><span class="pre">status</span></code> of your repository into your <code class="docutils literal"><span class="pre">README.md</span></code>.
By default you&#8217;re provided with just the image URL.
Click on the dropdown menu and select <code class="docutils literal"><span class="pre">Markdown</span></code> for the proper markdown code to paste into your <code class="docutils literal"><span class="pre">README</span></code>.</p>
<p><strong>Add the badge to the top of your README.md</strong> to display the test results from <code class="docutils literal"><span class="pre">Travis</span> <span class="pre">CI</span></code>.
It&#8217;ll update as your tests continue to pass or fail.
Keep in mind that <strong>the badge itself is tied to ONE branch</strong>.</p>
<p>And that&#8217;s it!</p>
</div>
</div>
<div class="section" id="extras">
<h2>Extras<a class="headerlink" href="#extras" title="Permalink to this headline">¶</a></h2>
<p>You&#8217;ll find that when you try to hook TravisCI up to a web app that uses a Postgres databse, it will fail.
This is because it&#8217;s looking for a database that doesn&#8217;t exist, as well as a service that doesn&#8217;t exist.
<a class="reference external" href="https://docs.travis-ci.com/user/database-setup/#PostgreSQL">These Travis docs</a> will show you how to integrate Postgres into your Travis tests.</p>
<p>On other GitHub repositories, you may have seen Coverage badges in addition to Travis badges.
That is not inherently a part of your Travis integration.
It can, however be a part of your repository.
Check out <a class="reference external" href="https://github.com/z4r/python-coveralls">these docs</a> and the <a class="reference external" href="https://coveralls.io/">coveralls website</a> for information on how to implement coverage badges into your repository.
You will need to sign up for an account there and enable your repo in much the same way as with Travis.</p>
<p>For a working implementation of both the TravisCI badge and the coverage badge, check the <code class="docutils literal"><span class="pre">master</span></code> branch of the <a class="reference external" href="https://github.com/nhuntwalker/expense_tracker">expense tracker repository</a>.</p>
</div>
<div class="section" id="next-steps">
<h2>Next Steps<a class="headerlink" href="#next-steps" title="Permalink to this headline">¶</a></h2>
<p>For your assignments, from here on, repeat this process.
This means that <strong>every repository that you make after this point should have Travis integration</strong>.
You won&#8217;t need the coverage badge, but it&#8217;d be awesome to see it.</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Automate Tests with Travis CI</a><ul>
<li><a class="reference internal" href="#automation-to-the-rescue">Automation to the Rescue</a><ul>
<li><a class="reference internal" href="#getting-started">Getting Started</a></li>
</ul>
</li>
<li><a class="reference internal" href="#configuring-travis">Configuring Travis</a><ul>
<li><a class="reference internal" href="#installing-python-packages">Installing Python Packages</a></li>
<li><a class="reference internal" href="#running-your-ci-tests">Running Your CI Tests</a></li>
<li><a class="reference internal" href="#advertise-your-awesomeness">Advertise Your Awesomeness</a></li>
</ul>
</li>
<li><a class="reference internal" href="#extras">Extras</a></li>
<li><a class="reference internal" href="#next-steps">Next Steps</a></li>
</ul>
</li>
</ul>

<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="nav-item nav-item-0"><a href="../index.html">Python 401 2.1 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &copy; Copyright 2014-2016, Cris Ewing, Nicholas Hunt-Walker.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.3.5.
    </div>
  </body>
</html>