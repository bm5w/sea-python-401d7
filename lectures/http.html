<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>The HTTP Protocol &mdash; Python 401 2.1 documentation</title>
    
    <link rel="stylesheet" href="../_static/pyramid.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '2.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="top" title="Python 401 2.1 documentation" href="../index.html" />
    <link rel="up" title="Tuesday" href="../schedule/week02/tue.html" />
    <link rel="next" title="Stack" href="stack.html" />
    <link rel="prev" title="Network Protocols in Python" href="protocols.html" />
<link rel="stylesheet" href="http://fonts.googleapis.com/css?family=Neuton&amp;subset=latin" type="text/css" media="screen" charset="utf-8" />
<link rel="stylesheet" href="http://fonts.googleapis.com/css?family=Nobile:regular,italic,bold,bolditalic&amp;subset=latin" type="text/css" media="screen" charset="utf-8" />

<link rel="stylesheet" href="../_static/custom.css" type="text/css" media="screen" charset="utf-8" />

<!--[if lte IE 6]>
<link rel="stylesheet" href="../_static/ie6.css" type="text/css" media="screen" charset="utf-8" />
<![endif]-->

  </head>
  <body role="document">
<div class="header">
  <div class="logo">
    <a href="../index.html">
      <img class="logo" src="../_static/cf_logo.png" alt="Logo"/>
      <p>Code Fellows</p>
    </a>
  </div>
</div>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="stack.html" title="Stack"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="protocols.html" title="Network Protocols in Python"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">Python 401 2.1 documentation</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="../schedule/week02/tue.html" accesskey="U">Tuesday</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput,
div.nbinput > div,
div.nbinput div[class^=highlight],
div.nbinput div[class^=highlight] pre,
div.nboutput,
div.nboutput > div,
div.nboutput div[class^=highlight],
div.nboutput div[class^=highlight] pre {
    background: none;
    border: none;
    padding: 0 0;
    margin: 0;
    box-shadow: none;
}

/* input/output containers */
div.nbinput,
div.nboutput {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
}

/* input container */
div.nbinput {
    padding-top: 5px;
}

/* last container */
div.nblast {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput > :first-child pre {
    color: navy;
}

/* output prompt */
div.nboutput > :first-child pre {
    color: darkred;
}

/* all prompts */
div.nbinput > :first-child[class^=highlight],
div.nboutput > :first-child[class^=highlight],
div.nboutput > :first-child {
    min-width: 11ex;
    padding-top: 0.4em;
    padding-right: 0.4em;
    text-align: right;
    flex: 0;
}

/* input/output area */
div.nbinput > :nth-child(2)[class^=highlight],
div.nboutput > :nth-child(2),
div.nboutput > :nth-child(2)[class^=highlight] {
    padding: 0.4em;
    -webkit-flex: 1;
    flex: 1;
}

/* input area */
div.nbinput > :nth-child(2)[class^=highlight] {
    border: 1px solid #cfcfcf;
    border-radius: 2px;
    background: #f7f7f7;
}

/* override MathJax center alignment in output cells */
div.nboutput div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.pngmath center alignment in output cells */
div.nboutput div.math p {
    text-align: left;
}

/* standard error */
div.nboutput  > :nth-child(2).stderr {
    background: #fdd;
}

/* ANSI colors */
.ansiblack { color: black; }
.ansired { color: darkred; }
.ansigreen { color: darkgreen; }
.ansiyellow { color: #c4a000; }
.ansiblue { color: darkblue; }
.ansipurple { color: darkviolet; }
.ansicyan { color: steelblue; }
/* See https://github.com/jupyter/nbconvert/issues/174 */
.ansigray { color: gray; }  /* nbconvert CSS */
.ansigrey { color: gray; }  /* nbconvert HTML output */

.ansibgblack { background-color: black; }
.ansibgred { background-color: red; }
.ansibggreen { background-color: green; }
.ansibgyellow { background-color: yellow; }
.ansibgblue { background-color: blue; }
.ansibgpurple { background-color: magenta; }
.ansibgcyan { background-color: cyan; }
.ansibggray { background-color: gray; }

.ansibold { font-weight: bold; }
</style>
<div class="section" id="the-http-protocol">
<h1>The HTTP Protocol<a class="headerlink" href="#the-http-protocol" title="Permalink to this headline">¶</a></h1>
<p>We&#8217;ve seen a number of network protocols so far.
Each of them consisted of a set of allowed commands and possible responses, <em>messages</em> that are passed from client to server and then from server to client.
In each protocol we&#8217;ve seen so far, these commands and responses have been <em>delimited</em>.
And for each of the protocols we&#8217;ve seen so far, that delimiter has been consistent: &lt;CRLF&gt;</p>
<p>A further consistency is shared between these protocols.
In each case we&#8217;ve seen so far, the <em>client</em> is responsible for initiating the interaction.
The <em>server</em> is passive until it receives some sort of request.</p>
<div class="section" id="http-characteristics">
<h2>HTTP Characteristics<a class="headerlink" href="#http-characteristics" title="Permalink to this headline">¶</a></h2>
<p>HTTP is no different.
It is also a message-centered protocol, supporting two-way communications between a client and a server.
Messages sent from the client to the server are called <em>requests</em>.
Messages sent from the server to the client are called <em>responses</em>.</p>
<div class="section" id="an-http-interaction">
<h3>An HTTP Interaction<a class="headerlink" href="#an-http-interaction" title="Permalink to this headline">¶</a></h3>
<p>In HTTP, both requests and responses share a common format.
There is a <em>required</em> initial line which contains either a command or a response code.
This is followed by one or more lines of <em>headers</em> (more on these below).
After all the headers, a single blank line separates the headers from the optional <em>body</em>.
As with our other protocols, the delimiter for lines is the <code class="docutils literal"><span class="pre">&lt;CRLF&gt;</span></code>.</p>
<p>Here are some examples:</p>
<p>HTTP Request (Ask for information):</p>
<div class="highlight-python"><div class="highlight"><pre>GET /index.html HTTP/1.1&lt;CRLF&gt;
Host: www.example.com&lt;CRLF&gt;
&lt;CRLF&gt;
</pre></div>
</div>
<p>HTTP Response (Provide answers):</p>
<div class="highlight-python"><div class="highlight"><pre>HTTP/1.1 200 OK&lt;CRLF&gt;
Date: Mon, 23 May 2005 22:38:34 GMT&lt;CRLF&gt;
Server: Apache/1.3.3.7 (Unix) (Red-Hat/Linux)&lt;CRLF&gt;
Last-Modified: Wed, 08 Jan 2003 23:11:55 GMT&lt;CRLF&gt;
Etag: &quot;3f80f-1b6-3e1cb03b&quot;&lt;CRLF&gt;
Accept-Ranges:  none&lt;CRLF&gt;
Content-Length: 438&lt;CRLF&gt;
Connection: close&lt;CRLF&gt;
Content-Type: text/html; charset=UTF-8&lt;CRLF&gt;
&lt;CRLF&gt;
&lt;438 bytes of content&gt;
</pre></div>
</div>
</div>
</div>
<div class="section" id="http-requests">
<h2>HTTP Requests<a class="headerlink" href="#http-requests" title="Permalink to this headline">¶</a></h2>
<p>Let&#8217;s start our investigation by looking a bit more closely at the HTTP <em>request</em>.
It has evolved across time from version 1.0 of the HTTP specification to the current version 1.1</p>
<div class="section" id="format">
<h3>Format<a class="headerlink" href="#format" title="Permalink to this headline">¶</a></h3>
<p>In HTTP 1.0, the only required line in an HTTP request looks like this:</p>
<div class="highlight-python"><div class="highlight"><pre>GET /path/to/index.html HTTP/1.0&lt;CRLF&gt;
&lt;CRLF&gt;
</pre></div>
</div>
<p>As the years passed, it grew more and more common to host more than one website (with different domain names) on a single machine.
This led to <em>virtual hosting</em>, which imposed a new requirement.
There had to be a way to tell a request for one website apart from one for another.
Version 1.1 of the HTTP specification added a single required <em>header</em>, <strong>Host</strong>:</p>
<p>HTTP 1.1 added a required header <strong>Host</strong>, to support virtual hosting:</p>
<div class="highlight-python"><div class="highlight"><pre>GET /path/to/index.html HTTP/1.1&lt;CRLF&gt;
Host: www.mysite1.com:80&lt;CRLF&gt;
&lt;CRLF&gt;
</pre></div>
</div>
<p>Every HTTP request <strong>must</strong> begin with a single line, broken by whitespace into three parts.
The three parts are called the <em>method</em>, the <em>URI</em> and the <em>protocol</em>.
We&#8217;ll look at each in turn below.</p>
<div class="build highlight-python"><div class="highlight"><pre>GET /path/to/index.html HTTP/1.1
</pre></div>
</div>
</div>
<div class="section" id="http-methods">
<h3>HTTP Methods<a class="headerlink" href="#http-methods" title="Permalink to this headline">¶</a></h3>
<p><strong>GET</strong> <code class="docutils literal"><span class="pre">/path/to/index.html</span> <span class="pre">HTTP/1.1</span></code></p>
<p>Every HTTP request first line must start with a <em>method</em>.
Although there are a total of eight possible HTTP methods, four are more commonly seen than others.
And among these, just two are by far the most common.</p>
<ul class="simple">
<li><strong>GET</strong></li>
<li><strong>POST</strong></li>
<li>PUT</li>
<li>DELETE</li>
</ul>
<p>These four methods can be mapped to the four basic steps (<em>CRUD</em>) of persistent storage:</p>
<ul class="build simple">
<li>POST = Create</li>
<li>GET = Read</li>
<li>PUT = Update</li>
<li>DELETE = Delete</li>
</ul>
</div>
<div class="section" id="safe-unsafe">
<h3>Safe &lt;&#8211;&gt; Unsafe<a class="headerlink" href="#safe-unsafe" title="Permalink to this headline">¶</a></h3>
<p>HTTP methods can be categorized as <strong>safe</strong> or <strong>unsafe</strong>, based on whether they might <em>change persistent data</em> on the server.
The distinction is entirely <em>normative</em>, which means that it is more a suggestion than a rule.
You, as an application developer are responsbile for ensuring that this holds true for your websites.
And you should never assume that other websites follow this rule.</p>
<ul class="build simple">
<li>Safe HTTP Methods<ul>
<li>GET</li>
</ul>
</li>
<li>Unsafe HTTP Methods<ul>
<li>POST</li>
<li>PUT</li>
<li>DELETE</li>
</ul>
</li>
</ul>
</div>
<div class="section" id="idempotent-non-idempotent">
<h3>Idempotent &lt;&#8211;&gt; Non-Idempotent<a class="headerlink" href="#idempotent-non-idempotent" title="Permalink to this headline">¶</a></h3>
<p>HTTP methods can be categorized as <strong>idempotent</strong>.
This is based on whether a given request using the method will <strong>always</strong> have the same result.
As with safe/unsafe, this distinction is <em>normative</em>.
Things <em>should</em> work this way, but do not always.
You should make sure that your sites <em>do</em>.</p>
<ul class="build simple">
<li>Idempotent HTTP Methods<ul>
<li>GET</li>
<li>PUT</li>
<li>DELETE</li>
</ul>
</li>
<li>Non-Idempotent HTTP Methods<ul>
<li>POST</li>
</ul>
</li>
</ul>
</div>
<div class="section" id="http-requests-uri">
<h3>HTTP Requests: URI<a class="headerlink" href="#http-requests-uri" title="Permalink to this headline">¶</a></h3>
<p><code class="docutils literal"><span class="pre">GET</span></code> <strong>/path/to/index.html</strong> <code class="docutils literal"><span class="pre">HTTP/1.1</span></code></p>
<p>Every HTTP request must include a <strong>URI</strong> used to determine the <strong>resource</strong> to be returned.
What is a URI?
How does it relate to the more familiar term URL?
<a class="reference external" href="http://stackoverflow.com/questions/176264/whats-the-difference-between-a-uri-and-a-url/1984225#1984225">This stack overflow question</a> provides a solid explanation.</p>
<p>In static systems, the URI maps directly to a filesystem location on the server.
In dynamic systems, it may still do so (PHP, CGI, the <em>Aspen</em> Python web framework).
However, it&#8217;s more common that it is used to determine what program should be used to build a response.</p>
<p>Static or dynamic, we call whatever that end point might be a <em>resource</em>.
A <em>resource</em> might refer to a file (.html, .jpg, .png, .css, .js), but it can also refer to dynamic scripts, raw data (csv, json, xml), or even api endpoints.
In any server application, this job of connecting the URI requested to the appropriate end point is very important.</p>
</div>
<div class="section" id="http-requests-protocol">
<h3>HTTP Requests: Protocol<a class="headerlink" href="#http-requests-protocol" title="Permalink to this headline">¶</a></h3>
<p><code class="docutils literal"><span class="pre">GET</span> <span class="pre">/path/to/index.html</span></code> <strong>HTTP/1.1</strong></p>
<p>The <em>protocol</em> specified by a request indicates which features a client is able to handle.
Version 1.1 of the specification added a number of useful advanced features.
In addition to virtual hosting, connections between clients and servers may be kept open across multiple request/response cycles.</p>
<p>It is quite rare now to see clients that only support version 1.0.
A new version (HTTP/2.0) is now finalized, and some services and browsers support it.
But it is still not widely seen and you can safely ignore it for the time being.
It is <em>very</em> different from the current version.</p>
</div>
</div>
<div class="section" id="http-responses">
<h2>HTTP Responses<a class="headerlink" href="#http-responses" title="Permalink to this headline">¶</a></h2>
<div class="left highlight-python"><div class="highlight"><pre>HTTP/1.1 200 OK
Content-Type: text/plain
&lt;CRLF&gt;
this is a pretty minimal response
</pre></div>
</div>
<p>In both HTTP 1.0 and 1.1, a proper response must contain an intial line.
This is followed by optional headers.
A single blank line finishes the header section and may be followed by an optional response body.
As with requests, the initial line of the response is strictly formatted, divided by whitespace into a <em>protocol</em> and a <em>response code</em>.</p>
<div class="section" id="http-response-codes">
<h3>HTTP Response Codes<a class="headerlink" href="#http-response-codes" title="Permalink to this headline">¶</a></h3>
<p><code class="docutils literal"><span class="pre">HTTP/1.1</span></code> <strong>200 OK</strong></p>
<p>All HTTP responses must include a <strong>response code</strong> indicating the outcome of the request.
The <em>code</em> itself is a three-digit number.
The <em>explanation</em> provides a clear-text, human readable description of the condition indicated.</p>
<p>There are five <em>categories</em> of response code.
Each indicates a different basic condition.
Individual codes within the categories provide more specific information.</p>
<ul class="build simple">
<li>1xx (HTTP 1.1 only) - Informational message</li>
<li>2xx - Success of some kind</li>
<li>3xx - Redirection of some kind</li>
<li>4xx - Client Error of some kind</li>
<li>5xx - Server Error of some kind</li>
</ul>
</div>
<div class="section" id="common-response-codes">
<h3>Common Response Codes<a class="headerlink" href="#common-response-codes" title="Permalink to this headline">¶</a></h3>
<p>There are certain HTTP response codes you are likely to see (and use) most often.
However, you should not feel constrained to using only these.
There are a lot of codes available, and using them well is communicative in the same way that using Python exceptions can be.
For a list of available, official response codes, see <a class="reference external" href="http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html">RFC 2616</a> or <a class="reference external" href="https://httpstatuses.com/">this list of HTTP Status Codes</a>.</p>
<ul class="build simple">
<li><code class="docutils literal"><span class="pre">200</span> <span class="pre">OK</span></code> - Everything is good</li>
<li><code class="docutils literal"><span class="pre">301</span> <span class="pre">Moved</span> <span class="pre">Permanently</span></code> - You should update your link</li>
<li><code class="docutils literal"><span class="pre">304</span> <span class="pre">Not</span> <span class="pre">Modified</span></code> - You should load this from cache</li>
<li><code class="docutils literal"><span class="pre">404</span> <span class="pre">Not</span> <span class="pre">Found</span></code> - You&#8217;ve asked for something that doesn&#8217;t exist</li>
<li><code class="docutils literal"><span class="pre">500</span> <span class="pre">Internal</span> <span class="pre">Server</span> <span class="pre">Error</span></code> - Something bad happened</li>
</ul>
</div>
</div>
<div class="section" id="http-headers">
<h2>HTTP Headers<a class="headerlink" href="#http-headers" title="Permalink to this headline">¶</a></h2>
<p>Headers allow clients and servers to exchange additional structured information.
They come after the initial line of a request or response.
Some headers may be used only for a request, some only for a response, and some are fine in either.</p>
<p>Headers always take the form of key/value pairs: <code class="docutils literal"><span class="pre">&lt;name&gt;:</span> <span class="pre">&lt;value&gt;</span></code>.
Names are always fully left-justified.
They must appear as the first characters on a line.
They must also be followed by a colon.</p>
<p>Any number of spaces or tabs may separate the name from the <em>value</em> of a header.
A header value can occupy multiple lines.
If the first character on a line in the header section of a request or response starts with whitespace, then it is considered to be part of the value for the last named header.</p>
<p>The names of headers are not case-sensitive.
However, the values may be, depending on the header.</p>
<p>It is well worth being familiar with the possible headers for HTTP.
You can <a class="reference external" href="http://www.cs.tut.fi/~jkorpela/http.html">read more about them here</a></p>
<p>There are a couple of headers we&#8217;ll talk about immediately, because they are so common.</p>
<div class="section" id="content-type">
<h3><code class="docutils literal"><span class="pre">Content-Type</span></code><a class="headerlink" href="#content-type" title="Permalink to this headline">¶</a></h3>
<p>The first is the <code class="docutils literal"><span class="pre">Content-Type</span></code> header.
It tells the receiver how to treat the data that is in the body of the request or response.
The header uses the <strong>mime-type</strong> system (Multi-purpose Internet Mail Extensions).
The list below gives you an idea how files of different types map to particular mime-types.
There are <em>many</em> <a class="reference external" href="http://www.freeformatter.com/mime-types-list.html">mime-type identifiers</a> and more are being registered all the time.</p>
<ul class="build simple">
<li>foo.jpeg - <code class="docutils literal"><span class="pre">Content-Type:</span> <span class="pre">image/jpeg</span></code></li>
<li>foo.png - <code class="docutils literal"><span class="pre">Content-Type:</span> <span class="pre">image/png</span></code></li>
<li>bar.txt - <code class="docutils literal"><span class="pre">Content-Type:</span> <span class="pre">text/plain</span></code></li>
<li>baz.html - <code class="docutils literal"><span class="pre">Content-Type:</span> <span class="pre">text/html</span></code></li>
</ul>
<p>The Python standard library provides a module that helps in determining the mimetype of a given file.
It&#8217;s called <a class="reference external" href="http://docs.python.org/2/library/mimetypes.html#module-mimetypes" title="(in Python v2.7)"><code class="xref py py-mod docutils literal"><span class="pre">mimetypes</span></code></a> (<a class="reference external" href="http://docs.python.org/3/library/mimetypes.html#module-mimetypes" title="(in Python v3.6)"><code class="xref py py-mod docutils literal"><span class="pre">py3</span></code></a>).
Using this module, you can guess the mime-type of a file based on the filename.
You can also map a particular file extension to a given mime-type.</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [1]: </span><span class="n">textfile</span> <span class="o">=</span> <span class="s2">&quot;/path/to/textfile.txt&quot;</span>
<span class="gp">In [2]: </span><span class="kn">import</span> <span class="nn">mimetypes</span>
<span class="gp">In [3]: </span><span class="n">mimetypes</span><span class="o">.</span><span class="n">guess_type</span><span class="p">(</span><span class="n">textfile</span><span class="p">)</span>
<span class="gh">Out[3]: </span><span class="go">(&#39;text/plain&#39;, None)</span>
<span class="gp">In [4]: </span><span class="kn">import</span> <span class="nn">os</span>
<span class="gp">In [5]: </span><span class="n">text_extension</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">textfile</span><span class="p">)</span>
<span class="gp">In [6]: </span><span class="n">text_extension</span>
<span class="gh">Out[6]: </span><span class="go">(&#39;/path/to/textfile&#39;, &#39;.txt&#39;)</span>
<span class="gp">In [7]: </span><span class="n">mimetypes</span><span class="o">.</span><span class="n">types_map</span><span class="p">[</span><span class="n">text_extension</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
<span class="gh">Out[7]: </span><span class="go">&#39;text/plain&#39;</span>
</pre></div>
</div>
</div>
<div class="section" id="date">
<h3><code class="docutils literal"><span class="pre">Date</span></code><a class="headerlink" href="#date" title="Permalink to this headline">¶</a></h3>
<p>Another common HTTP header is the <code class="docutils literal"><span class="pre">Date</span></code> header.
It represents the date and time that a response was generated.</p>
<p>The value for this header must be expressed in GMT, not local time.
It must be in a very specific format:</p>
<div class="highlight-python"><div class="highlight"><pre>Fri, 12 Feb 2010 16:23:03 GMT
</pre></div>
</div>
<p>The Python standard library also provides a way of getting exactly this format.
Since the format is almost exactly the same as that required for email headers, this method is found in a slightly unexpected module:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [9]: </span><span class="kn">import</span> <span class="nn">email.utils</span>
<span class="gp">In [10]: </span><span class="n">email</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">formatdate</span><span class="p">(</span><span class="n">usegmt</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gh">Out[10]: </span><span class="go">&#39;Mon, 07 Mar 2016 00:57:58 GMT&#39;</span>
</pre></div>
</div>
</div>
<div class="section" id="content-length">
<h3><code class="docutils literal"><span class="pre">Content-Length</span></code><a class="headerlink" href="#content-length" title="Permalink to this headline">¶</a></h3>
<p>A third common HTTP header is the <code class="docutils literal"><span class="pre">Content-Length</span></code> header.
This header is used to inform the receiver of a request or response how many bytes data to expect in the body.
Since HTTP does not specify a delimiter for a response body (unlike the SMTP, POP3 and IMAP protocols), this header is particularly important.</p>
<p>The value for the header should correspond to the number of bytes of data that will be returned (excluding headers).</p>
<p>For binary files like images calculating this value is quite straightforward:</p>
<div class="highlight-pycon"><div class="highlight"><pre><span class="go">In [1]: with open(&#39;Mars1.jpg&#39;, &#39;rb&#39;) as file_handle:</span>
<span class="go">  ....:     mars_image = file_handle.read()</span>
<span class="go">  ....:</span>
<span class="go">In [2]: length = len(mars_image)</span>
<span class="go">In [3]: length</span>
<span class="go">Out[3]: 1161387</span>
</pre></div>
</div>
<p>However, when text is involved it gets a bit more complicated.
Best practice in Python is to keep text that you are working with as <code class="docutils literal"><span class="pre">unicode</span></code> objects:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [4]: </span><span class="n">body</span> <span class="o">=</span> <span class="s1">u&#39;éclaire&#39;</span>
<span class="gp">In [5]: </span><span class="nb">len</span><span class="p">(</span><span class="n">body</span><span class="p">)</span>
<span class="gh">Out[5]: </span><span class="go">7</span>
</pre></div>
</div>
<p>Remember that a socket can <strong>only</strong> transmit bytes.
It cannot handle decoded unicode objects.
In Python you must be sure that the content of the response body you send has been encoded before it is handed off to the socket for transmission:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [6]: </span><span class="n">as_bytes</span> <span class="o">=</span> <span class="n">body</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span>
<span class="gp">In [7]: </span><span class="nb">len</span><span class="p">(</span><span class="n">as_bytes</span><span class="p">)</span>
<span class="gh">Out[7]: </span><span class="go">8</span>
</pre></div>
</div>
<p>Notice that the length of the encoded byte string is <em>longer</em> than the decoded unicode string.
This is because the encoded form of the <code class="docutils literal"><span class="pre">é</span></code> character is actually <em>two bytes</em> in length.</p>
<p>If the content you send over HTTP is text, the receiver should be able to decode it properly.
To do so, they must know what <em>codec</em> was used to encode it to bytes.
It is best practice to include information about what <em>codec</em> was used in a header.</p>
<p>It&#8217;s tempting to think of the <code class="docutils literal"><span class="pre">Content-Encoding</span></code> header as the proper place to send this data.
In fact that header is used to inform the client of <em>compressed</em> data (.zip or similar).
Instead, the correct way to inform the client of the encoding used is to append a <code class="docutils literal"><span class="pre">charset</span> <span class="pre">&lt;name&gt;</span></code> value to the <code class="docutils literal"><span class="pre">Content-Type</span></code> header:</p>
<div class="build highlight-python"><div class="highlight"><pre><span class="n">Content</span><span class="o">-</span><span class="n">Type</span><span class="p">:</span> <span class="n">text</span><span class="o">/</span><span class="n">plain</span><span class="p">;</span> <span class="n">charset</span><span class="o">=</span><span class="n">utf</span><span class="o">-</span><span class="mi">8</span>
</pre></div>
</div>
</div>
<div class="section" id="cookie">
<h3>Cookie<a class="headerlink" href="#cookie" title="Permalink to this headline">¶</a></h3>
<p>The last HTTP header to call out explicitly is the <code class="docutils literal"><span class="pre">Cookie</span></code> header.
This particular header is used both by the <em>client</em> and by the <em>server</em>.
The server can send data to the client in a <code class="docutils literal"><span class="pre">Cookie</span></code> header.
The client will send it back on the next request.
Cookies are thus the primary means of persisting data between individual request/response cycles.
They are used commonly to store <em>session-bound</em> data such as authentication state.</p>
</div>
</div>
<div class="section" id="wrap-up">
<h2>Wrap Up<a class="headerlink" href="#wrap-up" title="Permalink to this headline">¶</a></h2>
<p>We&#8217;ve learned about the HTTP protocol in this lesson.
We learned that there are Requests and Responses.
That each has a specific format.
That the header section of each will be separated from the body section by a blank line.
That the first line of each may be parsed to find out <em>methods</em>, <em>uris</em>, <em>status codes</em> and <em>protocol versions</em>.
We&#8217;ve also learned that headers are used to pass structured data.
And we&#8217;ve learned about a number of common headers.</p>
<p>For your assignments, you&#8217;ll be using this knowledge to build a rudimentary HTTP server.</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">The HTTP Protocol</a><ul>
<li><a class="reference internal" href="#http-characteristics">HTTP Characteristics</a><ul>
<li><a class="reference internal" href="#an-http-interaction">An HTTP Interaction</a></li>
</ul>
</li>
<li><a class="reference internal" href="#http-requests">HTTP Requests</a><ul>
<li><a class="reference internal" href="#format">Format</a></li>
<li><a class="reference internal" href="#http-methods">HTTP Methods</a></li>
<li><a class="reference internal" href="#safe-unsafe">Safe &lt;&#8211;&gt; Unsafe</a></li>
<li><a class="reference internal" href="#idempotent-non-idempotent">Idempotent &lt;&#8211;&gt; Non-Idempotent</a></li>
<li><a class="reference internal" href="#http-requests-uri">HTTP Requests: URI</a></li>
<li><a class="reference internal" href="#http-requests-protocol">HTTP Requests: Protocol</a></li>
</ul>
</li>
<li><a class="reference internal" href="#http-responses">HTTP Responses</a><ul>
<li><a class="reference internal" href="#http-response-codes">HTTP Response Codes</a></li>
<li><a class="reference internal" href="#common-response-codes">Common Response Codes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#http-headers">HTTP Headers</a><ul>
<li><a class="reference internal" href="#content-type"><code class="docutils literal"><span class="pre">Content-Type</span></code></a></li>
<li><a class="reference internal" href="#date"><code class="docutils literal"><span class="pre">Date</span></code></a></li>
<li><a class="reference internal" href="#content-length"><code class="docutils literal"><span class="pre">Content-Length</span></code></a></li>
<li><a class="reference internal" href="#cookie">Cookie</a></li>
</ul>
</li>
<li><a class="reference internal" href="#wrap-up">Wrap Up</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="protocols.html"
                        title="previous chapter">Network Protocols in Python</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="stack.html"
                        title="next chapter">Stack</a></p>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="stack.html" title="Stack"
             >next</a> |</li>
        <li class="right" >
          <a href="protocols.html" title="Network Protocols in Python"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">Python 401 2.1 documentation</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="../schedule/week02/tue.html" >Tuesday</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &copy; Copyright 2014-2016, Cris Ewing, Nicholas Hunt-Walker.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.3.5.
    </div>
  </body>
</html>